import{c as T,g as oe}from"./Cpj98o6Y.js";import{k as S,c,e as u,f as r,B as k,C as w,t as x,D as F,h as b,n as v,E as O,F as W,G as A,r as re,i as L,H as ne,w as ie}from"./DrOj-Nyz.js";import{_ as se}from"./Dse9ZBov.js";function ae(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var D=ae,le=typeof T=="object"&&T&&T.Object===Object&&T,de=le,ce=de,ue=typeof self=="object"&&self&&self.Object===Object&&self,ge=ce||ue||Function("return this")(),q=ge,pe=q,be=function(){return pe.Date.now()},fe=be,me=/\s/;function he(t){for(var e=t.length;e--&&me.test(t.charAt(e)););return e}var ke=he,ve=ke,ye=/^\s+/;function xe(t){return t&&t.slice(0,ve(t)+1).replace(ye,"")}var _e=xe,Te=q,Se=Te.Symbol,z=Se,R=z,H=Object.prototype,Pe=H.hasOwnProperty,je=H.toString,y=R?R.toStringTag:void 0;function Be(t){var e=Pe.call(t,y),l=t[y];try{t[y]=void 0;var g=!0}catch{}var i=je.call(t);return g&&(e?t[y]=l:delete t[y]),i}var we=Be,Oe=Object.prototype,Ie=Oe.toString;function Le(t){return Ie.call(t)}var Ne=Le,M=z,$e=we,Ce=Ne,Ee="[object Null]",Fe="[object Undefined]",V=M?M.toStringTag:void 0;function Re(t){return t==null?t===void 0?Fe:Ee:V&&V in Object(t)?$e(t):Ce(t)}var Me=Re;function Ve(t){return t!=null&&typeof t=="object"}var Ge=Ve,Qe=Me,Ue=Ge,We="[object Symbol]";function Ae(t){return typeof t=="symbol"||Ue(t)&&Qe(t)==We}var De=Ae,qe=_e,G=D,ze=De,Q=NaN,He=/^[-+]0x[0-9a-f]+$/i,Ke=/^0b[01]+$/i,Xe=/^0o[0-7]+$/i,Je=parseInt;function Ye(t){if(typeof t=="number")return t;if(ze(t))return Q;if(G(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=G(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=qe(t);var l=Ke.test(t);return l||Xe.test(t)?Je(t.slice(2),l?2:8):He.test(t)?Q:+t}var Ze=Ye,et=D,I=fe,U=Ze,tt="Expected a function",ot=Math.max,rt=Math.min;function nt(t,e,l){var g,i,o,n,a,d,f=0,N=!1,m=!1,P=!0;if(typeof t!="function")throw new TypeError(tt);e=U(e)||0,et(l)&&(N=!!l.leading,m="maxWait"in l,o=m?ot(U(l.maxWait)||0,e):o,P="trailing"in l?!!l.trailing:P);function j(s){var p=g,h=i;return g=i=void 0,f=s,n=t.apply(h,p),n}function Y(s){return f=s,a=setTimeout(_,e),N?j(s):n}function Z(s){var p=s-d,h=s-f,E=e-p;return m?rt(E,o-h):E}function $(s){var p=s-d,h=s-f;return d===void 0||p>=e||p<0||m&&h>=o}function _(){var s=I();if($(s))return C(s);a=setTimeout(_,Z(s))}function C(s){return a=void 0,P&&g?j(s):(g=i=void 0,n)}function ee(){a!==void 0&&clearTimeout(a),f=0,g=d=i=a=void 0}function te(){return a===void 0?n:C(I())}function B(){var s=I(),p=$(s);if(g=arguments,i=this,d=s,p){if(a===void 0)return Y(d);if(m)return clearTimeout(a),a=setTimeout(_,e),j(d)}return a===void 0&&(a=setTimeout(_,e)),n}return B.cancel=ee,B.flush=te,B}var it=nt;const st=oe(it),at={data(){return{searchQuery:"",filterOpen:!1,sortRule:"relevance",bookType:"type1",edition:"",publisher:""}},methods:{toggleFilter(){this.filterOpen=!this.filterOpen},searchBooks(){console.log("Searching for books with query:",this.searchQuery),console.log("Sort rule:",this.sortRule),console.log("Book type:",this.bookType),console.log("Edition:",this.edition),console.log("Publisher:",this.publisher)},emitFilter(){this.$emit("filter",{searchQuery:this.searchQuery,sortRule:this.sortRule,bookType:this.bookType,edition:this.edition,publisher:this.publisher})},debouncedSearch:st(function(){this.emitFilter()},3e3)},watch:{searchQuery:"debouncedSearch",sortRule:"debouncedSearch",bookType:"debouncedSearch",edition:"debouncedSearch",publisher:"debouncedSearch"}},lt={class:"container p-4 mx-auto bg-white rounded shadow search-bar"},dt={class:"flex items-center space-x-4"},ct={key:0,class:"p-4 mt-4 bg-gray-100 rounded"},ut={class:"mb-4"},gt={class:"mb-4"},pt={class:"mb-4"},bt={class:"mb-4"};function ft(t,e,l,g,i,o){return c(),u("div",lt,[r("div",dt,[k(r("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=n=>i.searchQuery=n),onInput:e[1]||(e[1]=(...n)=>o.debouncedSearch&&o.debouncedSearch(...n)),placeholder:"Nhập thông tin sách...",class:"flex-grow p-2 border rounded"},null,544),[[w,i.searchQuery]]),r("button",{onClick:e[2]||(e[2]=(...n)=>o.toggleFilter&&o.toggleFilter(...n)),class:"p-2 text-white bg-blue-500 rounded"},x(i.filterOpen?"Đóng bộ lọc":"Mở bộ lọc"),1),r("button",{onClick:e[3]||(e[3]=(...n)=>o.searchBooks&&o.searchBooks(...n)),class:"p-2 text-white bg-green-500 rounded"}," Tìm kiếm ")]),i.filterOpen?(c(),u("div",ct,[r("div",ut,[e[9]||(e[9]=r("label",{class:"block mb-2 font-bold"},"Sắp xếp",-1)),k(r("select",{"onUpdate:modelValue":e[4]||(e[4]=n=>i.sortRule=n),class:"w-full p-2 border rounded"},e[8]||(e[8]=[r("option",{value:"date"},"Ngày phát hành",-1),r("option",{value:"relevance"},"Sự liên quan",-1),r("option",{value:"popularity"},"Số lượt mượn",-1)]),512),[[F,i.sortRule]])]),r("div",gt,[e[11]||(e[11]=r("label",{class:"block mb-2 font-bold"},"Thể loại sách",-1)),k(r("select",{"onUpdate:modelValue":e[5]||(e[5]=n=>i.bookType=n),class:"w-full p-2 border rounded"},e[10]||(e[10]=[r("option",{value:""},"Không chọn",-1),r("option",{value:"type1"},"Thể loại 1",-1),r("option",{value:"type2"},"Thể loại 2",-1),r("option",{value:"type3"},"Thể loại 3",-1)]),512),[[F,i.bookType]])]),r("div",pt,[e[12]||(e[12]=r("label",{class:"block mb-2 font-bold"},"Lần tái bản",-1)),k(r("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=n=>i.edition=n),placeholder:"Nhập lần tái bản",class:"w-full p-2 border rounded"},null,512),[[w,i.edition]])]),r("div",bt,[e[13]||(e[13]=r("label",{class:"block mb-2 font-bold"},"Nhà xuất bản",-1)),k(r("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=n=>i.publisher=n),placeholder:"Nhập Nhà xuất bản",class:"w-full p-2 border rounded"},null,512),[[w,i.publisher]])])])):b("",!0)])}const K=S(at,[["render",ft],["__scopeId","data-v-a9db9fe0"]]),mt={name:"Pagination",inject:["gotoPage","gotoNxtPage","gotoPrePage","page"],methods:{getPageList(){let t=[];var e=this.page.current-2;for(e;e<=this.page.current;e++)e>1&&e<this.page.max&&t.push(e);for(;t.length<5&&e<this.page.max;)t.push(e),e++;return t}}},ht={class:"flex justify-center pagination"},kt={key:0,class:"flex flex-row gap-2 pagination"},vt={key:0,class:"page-item"},yt=["onClick"],xt={key:1,class:"page-item"};function _t(t,e,l,g,i,o){return c(),u("div",ht,[o.page?(c(),u("ul",kt,[r("li",{class:v(["page-item",o.page.current===1?"disabled":""])},[r("div",{class:"page-link","aria-label":"Previous",onClick:e[0]||(e[0]=n=>o.gotoPrePage())},e[4]||(e[4]=[r("span",{"aria-hidden":"true"},"«",-1)]))],2),r("li",{class:v(["page-item",o.page.current===1?"disabled":""])},[r("div",{class:"page-link",style:O(o.page.current===1?"background: #122179;	color: #fff;":""),onClick:e[1]||(e[1]=n=>o.gotoPage(1))}," 1 ",4)],2),o.page.current>4?(c(),u("li",vt,e[5]||(e[5]=[r("div",{class:"page-link"},"...",-1)]))):b("",!0),(c(!0),u(W,null,A(o.getPageList(),n=>(c(),u("li",{class:v(["page-item",o.page.current===n?"disabled":""]),key:n},[r("div",{class:"page-link",style:O(o.page.current===n?"background: #122179;	color: #fff;":""),onClick:a=>o.gotoPage(n)},x(n),13,yt)],2))),128)),o.page.current<o.page.max-3?(c(),u("li",xt,e[6]||(e[6]=[r("div",{class:"page-link"},"...",-1)]))):b("",!0),o.page.max!==1?(c(),u("li",{key:2,class:v(["page-item",o.page.current===o.page.max?"disabled":""])},[r("div",{class:"page-link",style:O(o.page.current===o.page.max?"background: #122179;	color: #fff;":""),onClick:e[2]||(e[2]=n=>o.gotoPage(o.page.max))},x(o.page.max),5)],2)):b("",!0),r("li",{class:v(["page-item",o.page.current===o.page.max?"disabled":""])},[r("div",{class:"page-link","aria-label":"Next",onClick:e[3]||(e[3]=n=>o.gotoNxtPage())},e[7]||(e[7]=[r("span",{"aria-hidden":"true"},"»",-1)]))],2)])):b("",!0)])}const X=S(mt,[["render",_t],["__scopeId","data-v-25878279"]]),Tt={components:{Pagination:X},props:{books:{type:Array,required:!0}},data(){return{page:{current:1,max:1},paginatedBooks:[]}},mounted(){this.page.max=Math.ceil(this.books.length/18),this.page.current=1,this.updatePaginatedBooks()},watch:{books:{handler(){this.page.max=Math.ceil(this.books.length/18),this.page.current=1,this.updatePaginatedBooks()},immediate:!0,deep:!0},page:{handler(){this.updatePaginatedBooks()},deep:!0}},methods:{updatePaginatedBooks(){console.log(this.page);const t=(this.page.current-1)*18,e=t+18;this.paginatedBooks=this.books.slice(t,e)},gotoPage(t){console.log(t,this.page),this.page.current=t,this.updatePaginatedBooks(),this.gotoTopList()},gotoNxtPage(){this.page.current<this.page.max&&this.page.current++,this.updatePaginatedBooks(),this.gotoTopList()},gotoPrePage(){this.page.current>1&&this.page.current--,this.updatePaginatedBooks(),this.gotoTopList()},gotoTopList(){document.getElementById("booklist").scrollIntoView({behavior:"smooth"})}},provide(){return{page:re(this.page),gotoPage:t=>this.gotoPage(t),gotoNxtPage:()=>this.gotoNxtPage(),gotoPrePage:()=>this.gotoPrePage()}}},St={class:"container mx-auto book-list-container",id:"booklist"},Pt={key:0,class:"grid grid-cols-1 gap-6 mt-4 sm:grid-cols-2 lg:grid-cols-5"},jt=["src","alt"],Bt={class:"mb-2 text-lg font-semibold"},wt={class:"text-gray-700"};function Ot(t,e,l,g,i,o){const n=se,a=X;return c(),u("div",St,[i.paginatedBooks?(c(),u("div",Pt,[(c(!0),u(W,null,A(i.paginatedBooks,d=>(c(),ne(n,{key:d.id,to:d.link,class:"p-4 bg-white rounded shadow book-card"},{default:ie(()=>[r("img",{src:d.cover,alt:d.title,class:"object-cover w-full h-48 mb-4 rounded"},null,8,jt),r("h3",Bt,x(d.title),1),r("p",wt,x(d.author),1)]),_:2},1032,["to"]))),128))])):b("",!0),L(a)])}const J=S(Tt,[["render",Ot],["__scopeId","data-v-694cd3de"]]),It={components:{BookSearch:K,BookList:J},data(){return{books:null,filteredBooks:[]}},async created(){try{const t=await fetch("/data/book.json");this.books=await t.json()}catch(t){console.error("Error fetching top books:",t)}this.filteredBooks=this.books},methods:{applyFilter(t){this.filteredBooks=this.books.filter(e=>e.title.includes(t.searchQuery)&&e.author.includes(t.publisher)&&(t.bookType==="all"||e.type===t.bookType)&&(t.edition===""||e.edition===t.edition))}}};function Lt(t,e,l,g,i,o){const n=K,a=J;return c(),u("div",null,[e[0]||(e[0]=r("h2",{class:"my-6 text-2xl font-bold text-center"},"Tìm sách",-1)),L(n,{onFilter:o.applyFilter},null,8,["onFilter"]),L(a,{books:i.filteredBooks},null,8,["books"])])}const Et=S(It,[["render",Lt],["__scopeId","data-v-be2c1995"]]);export{Et as default};
