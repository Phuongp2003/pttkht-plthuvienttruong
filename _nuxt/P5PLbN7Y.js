import{k as g,r as _,c as n,e as a,F as k,C as B,f as e,t as u,D as f,E as b,h as w,i as p,A as x,G as C,H as v}from"./DQ-OUx2J.js";import{_ as m}from"./n4-TGolx.js";import{u as P}from"./CgZIMj1m.js";const y={components:{Pagination:m},props:{books:{type:Array,required:!0}},data(){return{page:{current:1,max:1},paginatedBooks:[]}},mounted(){this.page.max=Math.ceil(this.books.length/18),this.page.current=1,this.updatePaginatedBooks()},watch:{books:{handler(){this.page.max=Math.ceil(this.books.length/18),this.page.current=1,this.updatePaginatedBooks()},immediate:!0,deep:!0},page:{handler(){this.updatePaginatedBooks()},deep:!0}},methods:{updatePaginatedBooks(){const o=(this.page.current-1)*18,s=o+18;this.paginatedBooks=this.books.slice(o,s)},gotoPage(o){this.page.current=o,this.updatePaginatedBooks(),this.gotoTopList()},gotoNxtPage(){this.page.current<this.page.max&&this.page.current++,this.updatePaginatedBooks(),this.gotoTopList()},gotoPrePage(){this.page.current>1&&this.page.current--,this.updatePaginatedBooks(),this.gotoTopList()},gotoTopList(){document.getElementById("booklist").scrollIntoView({behavior:"smooth"})},deleteBook(o){this.paginatedBooks=this.paginatedBooks.filter(s=>s.id!==o)},incrementBorrowCount(o){o.borrowCount?o.borrowCount++:o.borrowCount=1},decrementBorrowCount(o){!o.borrowCount||o.borrowCount<=1?o.borrowCount=1:o.borrowCount--},confirmBorrow(){this.$emit("confirmBorrow",this.paginatedBooks)}},provide(){return{page:_(this.page),gotoPage:o=>this.gotoPage(o),gotoNxtPage:()=>this.gotoNxtPage(),gotoPrePage:()=>this.gotoPrePage()}}},L={class:"container mx-auto book-list-container",id:"booklist"},$={key:0,class:"grid grid-cols-1 gap-6 mt-4"},D={class:"flex items-center"},N=["src","alt"],T={class:"flex-grow ml-4"},V={class:"mb-2 text-lg font-semibold"},j={class:"text-gray-700"},E={class:"flex items-center space-x-2"},I=["onClick"],A={class:"flex items-center space-x-1"},M=["onClick"],U=["onUpdate:modelValue"],F=["onClick"],X={class:"flex justify-center mt-6"};function q(o,s,h,d,i,r){const l=m;return n(),a("div",L,[i.paginatedBooks?(n(),a("div",$,[(n(!0),a(k,null,B(i.paginatedBooks,t=>(n(),a("div",{key:t.id,class:"p-4 bg-white rounded shadow-sm book-card shadow-neutral-600"},[e("div",D,[e("img",{src:t.cover,alt:t.title,class:"object-cover w-24 h-24 mb-4 rounded"},null,8,N),e("div",T,[e("h3",V,u(t.title),1),e("p",j,u(t.author),1)]),e("div",E,[e("button",{onClick:c=>r.deleteBook(t.id),class:"p-2 text-white bg-red-500 rounded"}," Delete ",8,I),e("div",A,[e("button",{onClick:c=>r.decrementBorrowCount(t),class:"p-2 text-black bg-gray-300 rounded"}," - ",8,M),f(e("input",{type:"number","onUpdate:modelValue":c=>t.borrowCount=c,class:"w-16 p-2 border rounded"},null,8,U),[[b,t.borrowCount,void 0,{number:!0}]]),e("button",{onClick:c=>r.incrementBorrowCount(t),class:"p-2 text-black bg-gray-300 rounded"}," + ",8,F)])])])]))),128))])):w("",!0),p(l,{class:"mt-4"}),e("div",X,[e("button",{class:"px-4 py-2 text-white bg-blue-500 rounded",onClick:s[0]||(s[0]=(...t)=>r.confirmBorrow&&r.confirmBorrow(...t))}," Xác nhận mượn ")])])}const G=g(y,[["render",q],["__scopeId","data-v-6855b7c0"]]),H={components:{BookListBC:G},data(){return{books:null,filteredBooks:[],loading:!1}},async created(){try{const{data:o,pending:s,error:h}=await P("books",()=>fetch("/data/bookUB.json").then(d=>d.json()));this.loading=s,this.books=o}catch(o){console.error("Error fetching top books:",o)}this.filteredBooks=this.books},methods:{handleConfirmBorrow(o){console.log("Books to borrow:",o),this.$router.push("/borrow-history")}}},S={key:1};function z(o,s,h,d,i,r){const l=v,t=x("BookListBC");return n(),a("div",null,[s[0]||(s[0]=e("h2",{class:"my-6 text-2xl font-bold text-center"},"Xác nhận sách mượn",-1)),i.loading?(n(),C(l,{key:0})):(n(),a("div",S)),p(t,{books:i.filteredBooks,onConfirmBorrow:r.handleConfirmBorrow},null,8,["books","onConfirmBorrow"])])}const Q=g(H,[["render",z],["__scopeId","data-v-335e0650"]]);export{Q as default};
